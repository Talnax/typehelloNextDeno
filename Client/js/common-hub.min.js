var statusHub={not_active:0,initialized:1,active:2,data_load:3,data_loaded:4,data_loaded_err:5},th=th||{};th.next=th.next||{};
th.next.CommonHub=function(f){function w(a){e=this;this.settingsTemplate=this.infoTemplate=this.noteItemTemplate=this.pinItemTemplate=this.commentItemTemplate=this.wallSubItemTemplate=this.wallItemTemplate=this.feedbackTemplate=this.perFilterTemplate=this.perThemeTemplate=this.personAsTemplate=this.ignoreTemplate=this.smsTemplate=this.profileTemplate=null;this.targetClass=a;this.InitializeHub(this)}function x(a){try{var b=function(b,c,d){a.showProgressBar(!1);hubIgnore&&hubIgnore.refreshUI();JSON.parse(b)},
c=function(b,c,d){console.log("ERROR[TalkHub->ctrlIgnore.addIgnore()]: "+d);a.showProgressBar(!1)};e.getHub(ctrlIgnore,"ignore-hub",function(d){d.init&&(ctrlIgnore=new th.next.IgnoreController);setTimeout(function(){ctrlIgnore.addIgnore(getUser(),a.userPerClick,b,c)},600)});a.showProgressBar(!0)}catch(d){console.log("ERROR(CommonHub.ignoreRoutine())"+d),a.showProgressBar(!1)}}function z(a,b){try{var c,d=function(b,d,e){a.showProgressBar(!1);isJsonData(b)&&Socket.emit(socketEvents.socket_sms_notification,
c)},k=function(b,d,c){console.log("ERROR[CommonHub->ctrlSms.sendSms()]: "+c);a.showProgressBar(!1)};e.getHub(ctrlSms,"sms-hub",function(e){e.init&&(ctrlSms=new th.next.SmsController);setTimeout(function(){c=ctrlSms.addSms(getUser(),a.userPerClick,b,d,k)},600)});a.showProgressBar(!0)}catch(h){console.log("ERROR(CommonHub.showSmsDlg())"+h),a.showProgressBar(!1)}}function A(a){try{var b=this,c=function(){try{a.showProgressBar(!0);var d=getUserProfile(a.userPerClick);isDefine(d.pic)&&(d.pic=encodeURIComponent(d.pic));
var c=JSON.stringify({user:d});ajaxCall(pathServer+"is-user-online","is-user-online="+c,function(d,c,e){a.showProgressBar(!1);d=JSON.parse(d);"object"===typeof d&&(d.param?(d=getUser(),Socket.emit(socketEvents.socket_person_notification,{user:a.userPerClick,person:d,status:b.statusPerson,msg:"Hey, "+d.nick+" make you "+b.statusPerson})):setTimeout(function(){ctrlPerson.addPerson(a.userPerClick,getUser(),b.statusPerson,function(b,d,c){a.showProgressBar(!1)},function(b,d,c){a.showProgressBar(!1)})},
600))},function(b,d,c){a.showProgressBar(!1)})}catch(e){console.log("ERROR(CommonHub.sendUserNotification())"+e),a.showProgressBar(!1)}},d=function(b,d,e){a.showProgressBar(!1);"object"===typeof JSON.parse(b)&&(hubPerson&&hubPerson.readAllPersons(getUser()),c())},k=function(b,d,c){console.log("ERROR[TalkHub->ctrlPerson.addPerson()]: "+c);a.showProgressBar(!1);alert("Server error for add person :(")},h=a.commonHub.personAsTemplate.find(".th-dlg-person-status").val();this.statusPerson=h;e.getHub(ctrlPerson,
"person-hub",function(b){b.init&&(ctrlPerson=new th.next.PersonController);setTimeout(function(){ctrlPerson.addPerson(getUser(),a.userPerClick,h,d,k)},600)});a.showProgressBar(!0)}catch(l){console.log("ERROR(CommonHub.makePersonAsRoutine())"+l),a.showProgressBar(!1)}}function B(a,b){try{a.preventDefault(),e.getHub(hubPin,"pin-hub",function(a){a.init&&(hubPin=new th.next.PinHub);hubPin.hubShow(!0)}),sendCallBack(b(hubPin))}catch(c){console.log("ERROR(CommonHub.actionPin())"+c),sendCallBack(b(hubPin))}}
function C(a,b){try{a.preventDefault(),e.getHub(hubNews,"news-hub",function(a){a.init&&(hubNews=new th.next.NewsHub);hubNews.hubShow(!0)}),sendCallBack(b(hubNews))}catch(c){console.log("ERROR(CommonHub.actionNews())"+c),sendCallBack(b(hubNews))}}function D(a,b){try{a.preventDefault(),e.getHub(hubNote,"note-hub",function(a){a.init&&(hubNote=new th.next.NoteHub);hubNote.hubShow(!0)}),sendCallBack(b(hubNote))}catch(c){console.log("ERROR(CommonHub.actionNote())"+c),sendCallBack(b(hubNote))}}function E(a,
b){try{a.preventDefault(),e.getHub(hubComment,"comment-hub",function(a){a.init&&(hubComment=new th.next.CommentHub);hubComment.hubShow(!0)}),sendCallBack(b(hubComment))}catch(c){console.log("ERROR(CommonHub.actionComment())"+c),sendCallBack(b(hubComment))}}function F(a,b){try{a.preventDefault(),e.getHub(hubTalk,"talk-hub",function(a){a.init&&(hubTalk=new th.next.TalkHub);hubTalk.hubShow(!0)}),sendCallBack(b(hubTalk))}catch(c){console.log("ERROR(CommonHub.actionTalk())"+c),sendCallBack(b(hubTalk))}}
function t(a,b){try{a.preventDefault(),e.getHub(hubNotice,"notice-hub",function(a){a.init&&(hubNotice=new th.next.NoticeHub);hubNotice.hubShow(!0)}),sendCallBack(b(t))}catch(c){console.log("ERROR(CommonHub.actionNotice())"+c),sendCallBack(b(t))}}function G(a,b){try{a.preventDefault(),e.getHub(hubSms,"sms-hub",function(a){a.init&&(hubSms=new th.next.SmsHub,hubSms.readAllUsers(!0,function(a){hubSms.hubShow(!0)}));hubSms.hubShow(!0)}),sendCallBack(b(hubSms))}catch(c){console.log("ERROR(CommonHub.actionSms())"+
c),sendCallBack(b(hubSms))}}function H(a,b){try{a.preventDefault(),e.getHub(hubHtmlAnalysis,"html-analysis-hub",function(a){a.init&&(hubHtmlAnalysis=new th.next.htmAnalysis);hubHtmlAnalysis.hubShow(!0)}),sendCallBack(b(hubHtmlAnalysis))}catch(c){console.log("ERROR(CommonHub.actionHtmlAnalysis())"+c),sendCallBack(b(hubSms))}}function I(a,b){try{a.preventDefault(),e.getHub(hubIgnore,"ignore-hub",function(a){a.init&&(hubIgnore=new th.next.IgnoreHub);hubIgnore.readAllIgnores();hubIgnore.hubShow(!0)}),
sendCallBack(b(hubIgnore))}catch(c){console.log("ERROR(CommonHub.actionIgnores())"+c),sendCallBack(b(hubIgnore))}}function J(a,b){try{a.preventDefault(),e.getHub(hubPerson,"person-hub",function(a){a.init&&(hubPerson=new th.next.PersonHub);hubPerson.hubStatus!==statusHub.data_loaded&&hubPerson.readAllPersons(getUser());hubPerson.hubShow(!0)}),sendCallBack(b(hubPerson))}catch(c){console.log("ERROR(CommonHub.actionPerson())"+c),sendCallBack(b(hubPerson))}}function K(a,b){try{a.preventDefault(),e.getHub(hubProfile,
"profile-hub",function(a){a.init&&(hubProfile=new th.next.ProfileHub);hubProfile.hubShow(!0);hubProfile.showFullProfile(getUser())}),sendCallBack(b(hubProfile))}catch(c){console.log("ERROR(CommonHub.actionProfile())"+c),sendCallBack(b(hubProfile))}}function L(a,b){try{a.preventDefault(),e.getHub(hubSearch,"search-hub",function(a){a.init&&(hubSearch=new th.next.SearchHub);hubSearch.hubShow(!0)}),sendCallBack(b(hubSearch))}catch(c){console.log("ERROR(CommonHub.actionSearch())"+c),sendCallBack(b(hubSearch))}}
function M(a,b){try{a.preventDefault(),e.getHub(hubWall,"wall-hub",function(a){a.init&&(hubWall=new th.next.WallHub);hubWall.hubShow(!0)}),sendCallBack(b(hubWall))}catch(c){console.log("ERROR(CommonHub.actionWall())"+c),sendCallBack(b(hubWall))}}function n(a,b,c,d){try{var e=!1,h=f(a.cssClassHub+" "+b),l=f(a.cssClassHub+" .th-header .btn-circle");if(!isDefine(a.commonHub[c])){var e=!0,p=f(d).html();a.commonHub[c]=f(p);a.commonHub[c].find(".btn-circle").click(function(){q(!1,h,a.commonHub[c],l)})}var m=
{firstCall:e,showDialog:h,hubCloseBtn:l,commonTemplate:a.commonHub[c]};q(!0,h,a.commonHub[c],l);return m}catch(v){return console.log("ERROR(CommonHub.initTemplateDlg())"+v),null}}function q(a,b,c,d){try{a?(b.append(c),b.css("display","block"),d.css("display","none")):(b.css("display","none"),b.remove(":first-child"),d.css("display","block"))}catch(e){console.log("ERROR(CommonHub.showTemplateDialog())"+e)}}function N(a,b,c,d){try{var e=!1,h=f(a.cssClassHub+" "+b),l=f(a.cssClassHub+" .th-header .btn-circle");
if(!isDefine(a.commonHub[c])){var e=!0,p=f(d).html();a.commonHub[c]=f(p)}var m={firstCall:e,showDialog:h,hubCloseBtn:l,commonTemplate:a.commonHub[c]};q(!0,h,a.commonHub[c],l);return m}catch(v){return console.log("ERROR(CommonHub.initTemplateDlg())"+v),null}}var e,g=w.prototype;g.InitializeHub=function(){try{var a=this.targetClass.cssClassHub;this.targetClass.headerProgress=f(a+" .th-common-progress-bar");this.targetClass.headerTopMenu=f(a+" .th-header .th-top-menu");this.targetClass.slideMainMenu=
f(a+" .th-header .th-slide-menu");this.targetClass.toolTipFooter=f(a+" .th-footer");this.targetClass.toolBar=f(a+" .th-ul-main-menu");this.targetClass.toolBarItem=f(a+" .th-ul-main-menu li");this.targetClass.slideMainMenuItem=null}catch(b){console.log("ERROR(CommonHub.Initialize())"+b)}};g.getHub=function(a,b,c){try{var d={init:!0};isDefine(a)?(d.init=!1,sendCallBack(c(d))):loadHub(b,function(a){"ok"===a&&sendCallBack(c(d))})}catch(e){console.log("ERROR(CommonHub.getHub())"+e)}};g.initHub=function(a){try{raiseToHighestZIndex(a.cssClassHub);
f(document).on("click",a.cssClassHub,function(b){b.preventDefault();raiseToHighestZIndex(a.cssClassHub);return!1});a.toolBarItem.mouseenter(function(b){b=b.target.getAttribute("data-tip");e.showPanelToolTip(a,b,!0)});a.toolBar.mouseleave(function(){e.showPanelToolTip(a,"",!1)});a.headerTopMenu.mouseenter(function(){isDefine(getUser())&&a.slideMainMenu.css("display","block")});a.slideMainMenu.mouseleave(function(){isDefine(getUser())&&(a.slideMainMenu.css("display","none"),f(this).find(".th-slide-menu-separator-subset").css("display",
"none"))});a.slideMainMenu.find(".th-slide-menu-separator .th-slide-menu-separator-text").mouseenter(function(){f(this).css("color","black");f(this).parent().find(".th-slide-menu-separator-subset").css("display","block")});a.slideMainMenu.find(".th-slide-menu-separator").mouseleave(function(){f(this).find(".th-slide-menu-separator-text").css("color","white")});var b=a.cssClassHub+" .th-slide-menu-ul li.th-slide-menu-item";a.slideMainMenuItem=f(b);f(document).on("click",b,a.onMainMenuAction_Click);
a.slideMainMenuItem.mouseenter(function(b){isDefine(getUser())&&(b=f(b.target).closest("li.th-slide-menu-item").attr("data-tip"),e.showPanelToolTip(a,b,!0))});f(document).on("click",a.cssClassHub+" .th-header .btn-circle",function(){a.hubShow(!1)});f(a.cssClassHub).draggable({handle:".drag-panel"})}catch(c){console.log("ERROR(CommonHub.initHub())"+c)}};g.showPanelToolTip=function(a,b,c){try{c?(a.toolTipFooter.css("display","block"),a.toolTipFooter.find(".footer-tool-tip").html(b)):a.toolTipFooter.css("display",
"none")}catch(d){console.log("ERROR(CommonHub.showPanelToolTip())"+d)}};g.getHubZIndex=function(a){try{return parseInt(f(a.cssClassHub).css("z-index"))}catch(b){return console.log("ERROR(CommonHub.getHubZIndex())"+b),-1}};g.isHubOnTop=function(a){try{return parseInt(f(a.cssClassHub).css("z-index"))===zIndex?!0:!1}catch(b){return console.log("ERROR(CommonHub.getHubZIndex())"+b),!1}};g.onMainMenuAction_Click=function(a,b){try{a.slideMainMenu.css("display","none");var c=f(b.target).closest("li.th-slide-menu-item").attr("data-action"),
d={pin:B,news:C,note:D,comment:E,talk:F,"html-analysis":H,sms:G,ignores:I,friends:J,profile:K,search:L,wall:M,notice:t},k=null;if(d.hasOwnProperty(c))d[c](b,function(a){k=a});else"feedback"===c?e.showFeedbackDlg(a,a.feedbackClass):"settings"===c&&e.showSettingsDlg(a,a.settingsClass);setTimeout(function(){k&&raiseToHighestZIndex(k.cssClassHub)},1E3)}catch(h){console.log("ERROR(CommonHub.onMainMenuAction_Click())"+h)}};g.fromHubToHub=function(a,b,c){};g.hubShow=function(a,b){try{b?(f(a.cssClassHub).css("display",
"block"),".hub-center"!==a.cssClassHub&&(a.statusShow=!0,hubOpening++),hubCenter&&hubCenter.hubShow(!1)):(f(a.cssClassHub).css("display","none"),hubOpening--,a.statusShow=!1,0===hubOpening&&(hubCenter?hubCenter.hubShow(!0):loadHub("hub-center",function(a){"ok"===a&&(hubCenter||(hubCenter=new th.next.HubCenter),hubCenter.hubShow(0<hubOpening?!1:!0))})))}catch(c){console.log("ERROR(CommonHub.hubShow())"+c)}};g.hubRemove=function(a){try{var b=f(a.cssClassHub);b[0].parentNode.removeChild(b[0])}catch(c){console.log("ERROR(CommonHub.hubRemove())"+
c)}};g.setScrollHubPosition=function(a){try{var b=f(window).scrollTop(),c=f(window).scrollLeft(),b=b+yPosition,c=c+xPosition;f(a.cssClassHub).css("top",b+"px");f(a.cssClassHub).css("left",c+"px");xPosition=xStart;yPosition=yStart}catch(d){console.log("ERROR(CommonHub.setHubPosition())"+d)}};g.setHubPosition=function(a){try{var b=yPosition,c=xPosition;f(a.cssClassHub).css("top",b+"px");f(a.cssClassHub).css("left",c+"px");xPosition+=xDelta;yPosition+=yDelta}catch(d){console.log("ERROR(CommonHub.setHubPosition())"+
d)}};g.setUserIcon=function(a,b){try{a[0].removeAttribute("style"),a.removeClass("user-image-undefine").removeClass("user-image-female").removeClass("user-image-male"),"female"===b.gender?a.addClass("user-image-female"):"male"===b.gender?a.addClass("user-image-male"):a.addClass("user-image-undefine"),isDefine(b.pic)&&""!==b.pic&&a[0].setAttribute("style","background-image: url("+decodeURIComponent(b.pic)+");")}catch(c){console.log("ERROR(CommonHub.setUserIcon())"+c)}};g.removeMainMenuItem=function(a,
b){try{var c=f("#th-main-menu-template").html(),d=f(c).closest("ul"),e=f(d).find('li[data-action="'+b+'"]');0<e.length&&e.remove();f(a.cssClassHub+" .th-slide-menu").append(d)}catch(h){console.log("ERROR(CommonHub.removeItemFromMainMenu())"+h)}};g.showProgressBar=function(a,b){try{b?(a.headerTopMenu.css("display","none"),a.headerProgress.css("display","block")):(a.headerProgress.css("display","none"),a.headerTopMenu.css("display","block"))}catch(c){console.log("ERROR(CommonHub.showProgressBar())"+
c)}};g.showProfileDlg=function(a,b,c){try{var d=function(c,d,h){a.showProgressBar(!1);if(isJsonData(c))if(d=JSON.parse(c),0<d.param.length){n(a,b,"profileTemplate","#th-dlg-template-profile");c=a.commonHub.profileTemplate;d=d.param[0];try{if(isDefine(d)&&isDefine(c)){c.find(".prf-nick").text(d.nick);c.find(".prf-lng").text(d.language);c.find(".prf-country").text(d.country);c.find(".prf-gender").text(d.gender);var k=isDefine(d.city)?0<d.city.length?d.city:"...":"...";c.find(".prf-city").text(decodeURIComponent(k));
k=isDefine(d.hobbies)?0<d.hobbies.length?d.hobbies:"...":"...";c.find(".prf-hobbies").text(decodeURIComponent(k));k=isDefine(d.interests)?0<d.interests.length?d.interests:"...":"...";c.find(".prf-interests").text(decodeURIComponent(k));var f=c.find(".prf-picture");e.setUserIcon(f,d)}}catch(g){console.log("ERROR(TalkHub.bindFullProfile())"+g)}}else alert("Profile of user doesn't exist :(");else alert("We can't get data :(")},k=function(b,c,d){console.log("ERROR[TalkHub->ctrlTalk.getFullProfile()]: "+
d);alert("We can't get data :(");a.showProgressBar(!1)};e.getHub(ctrlProfile,"profile-hub",function(b){b.init&&(ctrlProfile=new th.next.ProfileController);setTimeout(function(){ctrlProfile.getFullProfile(a.userPerClick,d,k);sendCallBack(c(null))},600)});a.showProgressBar(!0)}catch(h){console.log("ERROR(CommonHub.showProfileDlg()): "+h)}};g.showSettingsDlg=function(a,b){try{n(a,b,"settingsTemplate","#th-dlg-template-settings")}catch(c){console.log("ERROR(CommonHub.showSettingsDlg()): "+c)}};g.showInfoDlg=
function(a,b,c,d){try{n(a,b,"infoTemplate","#th-dlg-template-info"),a.commonHub.infoTemplate.find(".th-template-info").html(c)}catch(e){console.log("ERROR(CommonHub.showInfoDlg())"+e)}};g.showFeedbackDlg=function(a,b){try{var c=function(b){b=encodeURIComponent(removeLineBreaks(b));b={dbcall:"db-insert",dbcollection:"feedback",dbrequest:{user:getUserId(getUser()),feedback:b}};var c=JSON.stringify(b);setTimeout(function(){ajaxCall(pathServer+"feedback","feedback="+c,function(b,c,d){a.showProgressBar(!1)},
function(b,c,d){a.showProgressBar(!1)})},600)},d=n(a,b,"feedbackTemplate","#th-dlg-template-feedback");d.firstCall&&a.commonHub.feedbackTemplate.find(".th-btn-send-feedback").click(function(){var b=a.commonHub.feedbackTemplate.find(".th-dlg-feedback-text"),e=b.val();1>e.length?alert("Hey type some feedback :)"):(b.val(""),c(e),q(!1,d.showDialog,a.commonHub.feedbackTemplate,d.hubCloseBtn),a.showProgressBar(!0))});a.commonHub.feedbackTemplate.find(".th-template-nick").html(getUser().nick)}catch(e){console.log("ERROR(CommonHub.showFeedbackDlg())"+
e)}};g.showWallItemDlg=function(a,b,c){try{isDefine(ctrlWall)||(ctrlWall=new th.next.WallController);var d=n(a,b,"wallItemTemplate","#th-dlg-template-wall-item"),k=a.commonHub.wallItemTemplate,f=k.find(".th-dlg-title"),l=k.find(".th-dlg-wall-item-text"),p=k.find(".th-dlg-wall-item-title"),m=k.find(".th-dlg-wall-item-link"),g=k.find(".th-dlg-wall-item-image-link"),s=k.find(".th-btn-div-fill-content");l.val("");p.val("");m.val("");g.val("");b="block";f.html("ADD POST TO THE WALL");b="block";p.closest(".th-dlg-data").css("display",
b);m.closest(".th-dlg-data").css("display",b);g.closest(".th-dlg-data").css("display",b);s.css("display",b);d.firstCall&&(k.find(".th-btn-fill-wall-post-by-web-content").click(function(){p.val(document.title);m.val(document.URL);l.val(getMetaContent("description"))}),k.find(".th-btn-add-wall-post").click(function(){var b=l.val(),f=p.val(),h=m.val(),s=g.val();if(1>b.length)e.showInfoDlg(a,".wall-hub-dlg-info","Hey type some post :)",function(a){});else{var u=k.find(".th-dlg-wall-item-select-person-status").val().trim(),
n=k.find(".th-dlg-wall-item-select-language").val().trim();ctrlWall.addWallPost({title:f,msg:b,link:h,img:s,status:u,language:n},a,c);q(!1,d.showDialog,a.commonHub.wallItemTemplate,d.hubCloseBtn)}}));a.commonHub.wallItemTemplate.find(".th-template-nick").html(getUser().nick)}catch(u){console.log("ERROR(CommonHub.showWallItemDlg())"+u)}};g.showSubPostWallItemDlg=function(a,b,c){try{isDefine(ctrlWall)||(ctrlWall=new th.next.WallController);var d=n(a,b,"wallSubItemTemplate","#th-dlg-template-wall-item"),
f=a.commonHub.wallSubItemTemplate.find(".th-dlg-title"),h=a.commonHub.wallSubItemTemplate.find(".th-dlg-wall-item-text"),l=a.commonHub.wallSubItemTemplate.find(".th-dlg-wall-item-title"),g=a.commonHub.wallSubItemTemplate.find(".th-dlg-wall-item-link"),m=a.commonHub.wallSubItemTemplate.find(".th-dlg-wall-item-image-link"),v=a.commonHub.wallSubItemTemplate.find(".th-btn-div-fill-content");h.val("");l.val("");g.val("");m.val("");f.html("ADD COMMENT TO THE POST");l.closest(".th-dlg-data").css("display",
"none");g.closest(".th-dlg-data").css("display","none");m.closest(".th-dlg-data").css("display","none");v.css("display","none");d.firstCall&&(a.commonHub.wallSubItemTemplate.find(".th-btn-fill-wall-post-by-web-content").click(function(){l.val(document.title);g.val(document.URL);h.val(getMetaContent("description"))}),a.commonHub.wallSubItemTemplate.find(".th-btn-add-wall-post").click(function(){var b=h.val();l.val();g.val();m.val();1>b.length?e.showInfoDlg(a,".wall-hub-dlg-info","Hey type some post :)",
function(a){}):(ctrlWall.addWallSubPost(b,a,c),q(!1,d.showDialog,a.commonHub.wallSubItemTemplate,d.hubCloseBtn))}));a.commonHub.wallSubItemTemplate.find(".th-template-nick").html(getUser().nick)}catch(s){console.log("ERROR(CommonHub.showSubPostWallItemDlg())"+s)}};g.showPinItemDlg=function(a,b,c,d,f){try{isDefine(ctrlPin)||(ctrlPin=new th.next.PinController);var h=n(a,b,"pinItemTemplate","#th-dlg-template-pin-item"),l=function(a,b){try{var d={dlgTl:b.find(".th-dlg-title"),pinBtn:b.find(".th-btn-add-pin-post"),
elMsg:b.find(".th-dlg-pin-item-text"),elTtl:b.find(".th-dlg-pin-item-title"),elLnk:b.find(".th-dlg-pin-item-link"),elTag:b.find(".th-dlg-pin-item-tags"),elImg:b.find(".th-dlg-pin-item-image-link")};"edit"===c?(d.dlgTl.html("EDIT THE PIN"),d.pinBtn.text("UPDATE"),d.elTtl.val(a.title),d.elLnk.val(a.link),d.elMsg.val(a.msg),d.elImg.val(a.pic),d.elTag.val(a.tags)):"create"===c&&(d.dlgTl.html("CREATE NEW PIN"),d.pinBtn.text("CREATE"),d.elTtl.val(0<document.title.length?document.title:""),d.elLnk.val(0<
document.URL.length?document.URL:""),d.elTag.val(""),d.elMsg.val(""),d.elMsg.val(getMetaContent("description")),d.elImg.val(""));return d}catch(e){return console.log("ERROR(CommonHub.showPinItemDlg().initDlg())"+e),null}}(d,a.commonHub.pinItemTemplate);if(null===l)return sendCallBack(e.pinCallBack(!0,null));e.elDlg=l;e.pinAction=c;e.pinCallBack=f;e.pinInstance=a;h.firstCall&&e.elDlg.pinBtn.click(function(b){b.preventDefault();b=e.elDlg.elMsg.val();var c=e.elDlg.elTtl.val(),f=e.elDlg.elLnk.val();1>
c.length||1>b.length||1>f.length?alert("Hey type some note content :)"):(q(!1,h.showDialog,a.commonHub.pinItemTemplate,h.hubCloseBtn),b={id:isDefine(d)?d.id:"",msg:b,title:c,link:f,pic:e.elDlg.elImg.val(),tags:e.elDlg.elTag.val()},a.showProgressBar(!0),ctrlPin["edit"===e.pinAction?"updatePin":"addPin"](b,function(b,c){a.showProgressBar(!1);return sendCallBack(e.pinCallBack(b,c))}));return!1})}catch(g){return console.log("ERROR(CommonHub.showFeedbackDlg())"+g),sendCallBack(e.pinCallBack(!0,null))}};
g.showNoteItemDlg=function(a,b,c,d,g){try{var h=function(a){try{var b=f(".th-dlg-note-item .template-status-icon");b.removeClass("note-status-define").removeClass("note-status-progress").removeClass("note-status-complete");b.addClass(a===note_status.define?"note-status-define":a===note_status.progress?"note-status-progress":"note-status-complete")}catch(c){console.log("ERROR(NoteHub.showNoteItemDlg.setNoteStatusImage()): "+c)}},l=function(){try{var a=r.val().trim(),b=y.val(),c=n.val(),d=t.val();if(1>
b.length||1>a.length)return alert("Hey type some note content :)"),!1;var f={id:isDefine(e.noteData)?e.noteData.id:"",msg:a,status:c,title:b,link:"",pic:"",tags:d};"edit"===e.noteAction?(e.noteInstance.noteChanged=!1,ctrlNote.updateNote(f,e.noteInstance,e.noteCallBack)):"create"===e.noteAction&&(e.noteInstance.noteChanged=!1,ctrlNote.addNote(f,e.noteInstance,e.noteCallBack));return!0}catch(g){console.log("ERROR(CommonHub.showNoteItemDlg.updateNote()): "+g)}};isDefine(ctrlNote)||(ctrlNote=new th.next.NoteController);
var p=N(a,b,"noteItemTemplate","#th-dlg-template-note-item"),m=a.commonHub.noteItemTemplate,n=m.find(".th-dlg-note-item-status"),s=m.find(".th-btn-add-note-post"),u=m.find(".th-dlg-title"),r=m.find(".th-dlg-note-item-text"),y=m.find(".th-dlg-note-item-title"),t=m.find(".th-dlg-note-item-tags");r.val("");y.val("");t.val("");n.val("define");try{"edit"===c?(u.html("EDIT THE NOTE"),s.text("UPDATE"),h(d.status),y.val(d.title),t.val(d.tags),r.val(" "+d.msg+"\n\n"),n.val(d.status),r.focus(),r[0].setSelectionRange(r.val().length,
0)):"create"===c&&(u.html("CREATE NEW NOTE"),s.text("ADD"),r.val(" "),h(note_status.define),r.focus(),r[0].setSelectionRange(0,0))}catch(w){console.log("ERROR(NoteHub.showNoteItemDlg.showHidePerAction()): "+w)}e.noteAction=c;e.noteCallBack=g;e.noteInstance=a;e.noteData=d;e.noteContent=r.val();p.firstCall&&(a.commonHub.noteItemTemplate.find(".btn-circle").click(function(){if(!0!==e.noteInstance.noteChanged||!0!==confirm("Do you want to save this Note before close?")||l())e.noteInstance.noteChanged=
!1,q(!1,p.showDialog,a.commonHub.noteItemTemplate,p.hubCloseBtn)}),r.bind("propertychange input paste",function(a){e.noteContent!==r.val()&&(e.noteInstance.noteChanged=!0)}),n.change(function(a){h(a.target.value)}),s.click(function(){l()&&q(!1,p.showDialog,a.commonHub.noteItemTemplate,p.hubCloseBtn)}))}catch(x){console.log("ERROR(CommonHub.showNoteItemDlg())"+x)}};g.showCommentItemDlg=function(a,b,c,d){try{isDefine(ctrlComment)||(ctrlComment=new th.next.CommentController);var f=n(a,b,"commentItemTemplate",
"#th-dlg-template-comment-item"),g=a.commonHub.commentItemTemplate.find(".th-dlg-title"),l=a.commonHub.commentItemTemplate.find(".th-dlg-comment-item-text"),p=a.commonHub.commentItemTemplate.find(".th-dlg-comment-item-link"),m=a.commonHub.commentItemTemplate.find(".th-dlg-comment-item-image-link");b="none";c?g.html("ADD COMMENT"):(g.html("ADD COMMENT TO THE PAGE"),b="block");p.closest(".th-dlg-data").css("display",b);m.closest(".th-dlg-data").css("display",b);e.Comments=c;e.commentCallBack=d;e.thisInstance=
a;f.firstCall&&a.commonHub.commentItemTemplate.find(".th-btn-add-comment-post").click(function(){var b=l.val(),c=p.val(),d=m.val();1>b.length?e.showInfoDlg(a,".comment-hub-dlg-info","Hey type some comment :)",function(a){}):(l.val(""),p.val(""),m.val(""),e.Comments?ctrlComment.addCommentSubPost(b,e.thisInstance,e.commentCallBack):ctrlComment.addCommentPost(b,c,d,e.thisInstance,e.commentCallBack),q(!1,f.showDialog,a.commonHub.commentItemTemplate,f.hubCloseBtn))});a.commonHub.commentItemTemplate.find(".th-template-nick").html(getUser().nick)}catch(t){console.log("ERROR(CommonHub.showCommentItemDlg())"+
t)}};g.showSmsDlg=function(a,b,c){try{var d=n(a,b,"smsTemplate","#th-dlg-template-sms");d.firstCall&&a.commonHub.smsTemplate.find(".th-btn-send-sms").click(function(){var b=a.commonHub.smsTemplate.find(".th-dlg-sms-text"),c=b.val();1>c.length?e.showInfoDlg(a,".talk-hub-dlg-info","Hey type some message :)",function(a){}):(b.val(""),z(a,c),q(!1,d.showDialog,a.commonHub.smsTemplate,d.hubCloseBtn))});a.commonHub.smsTemplate.find(".th-template-nick").html(a.userPerClick.nick);sendCallBack(c(null))}catch(f){console.log("ERROR(CommonHub.showSmsDlg()): "+
f)}};g.showIgnoreDlg=function(a,b){try{var c=n(a,b,"ignoreTemplate","#th-dlg-template-ignore");c.firstCall&&a.commonHub.ignoreTemplate.find(".th-btn-ignore").click(function(){x(a);q(!1,c.showDialog,a.commonHub.ignoreTemplate,c.hubCloseBtn)});a.commonHub.ignoreTemplate.find(".th-template-nick").html(a.userPerClick.nick)}catch(d){console.log("ERROR(CommonHub.showIgnoreDlg()): "+d)}};g.showMakePersonAsDlg=function(a,b){function c(){var b=a.commonHub.personAsTemplate.find(".th-dlg-person-status"),c;for(c in personStatus)if(personStatus.hasOwnProperty(c)){var d=
document.createElement("option");d.innerHTML=c;d.value=c;b[0].appendChild(d)}}try{var d=n(a,b,"personAsTemplate","#th-dlg-template-make-person-as");d.firstCall&&(a.commonHub.personAsTemplate.find(".btn-make-person-as").click(function(){A(a);q(!1,d.showDialog,a.commonHub.personAsTemplate,d.hubCloseBtn)}),c());a.commonHub.personAsTemplate.find(".th-template-nick").html(a.userPerClick.nick)}catch(e){console.log("ERROR(CommonHub.showMakePersonAsDlg()): "+e)}};g.showDlgPerTheme=function(a,b,c){try{var d=
function(b){b=a.commonHub.perThemeTemplate.find(".th-dlg-channel-per-theme-text");var d=b.val();1>d.length?e.showInfoDlg(a,".talk-hub-dlg-info","Hey type some channel :)",function(a){}):(b.val(""),sendCallBack(c(d)),q(!1,f.showDialog,a.commonHub.perThemeTemplate,f.hubCloseBtn))},f=n(a,b,"perThemeTemplate","#th-dlg-template-per-theme");f.firstCall&&(a.commonHub.perThemeTemplate.find(".th-btn-open-channel-per-theme").click(d),a.commonHub.perThemeTemplate.find(".th-dlg-channel-per-theme-text").keyup(function(a){13===
a.keyCode&&d(a)}))}catch(g){console.log("ERROR(CommonHub.showDlgPerTheme()): "+g)}};return w}(thJQ);
