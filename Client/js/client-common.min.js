var Socket=null,User=null,USERs={},aChannel=null,zIndex=0,MSG_LENGTH=360,isNewUser=!1,hubOpening=0,yStart=9,xStart=9,yPosition=yStart,xPosition=xStart,yDelta=36,xDelta=33,hubCenter=null,hubLogIn=null,hubTalk=null,ctrlTalk=null,hubProfile=null,ctrlProfile=null,hubIgnore=null,ctrlIgnore=null,hubPerson=null,ctrlPerson=null,hubSms=null,ctrlSms=null,hubSearch=null,ctrlSearch=null,hubWall=null,ctrlWall=null,hubComment=null,ctrlComment=null,hubPin=null,ctrlPin=null,hubNews=null,ctrlNews=null,hubNote=null,
ctrlNote=null,hubNotice=null,ctrlNotice=null,hubHtmlAnalysis=null,ctrlHtmlAnalysis=null,hubTextAnalysis=null,ctrlTextAnalysis=null,hubCenterController=hubCenter=null,ctrlSettings=null,monthName="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),userId={id:null,nick:null,pwd:null},storageNick="th-nick",storagePswd="th-pswd";function initSocketIO(){try{Socket=io.connect(pathServer),socketRouter()}catch(a){console.log("FAIL[client-socket-router.initSocketIO()]: ",a.message)}}
function socketRouter(){try{null!==Socket&&(Socket.on(socketEvents.connect,function(){console.log("Connect to socket-service of TypeHello")}),Socket.on(socketEvents.disconnect,function(){console.log("Disconnect from socket-service of TypeHello")}),Socket.on(socketEvents.socket_login_completed,function(a){hubLogIn&&hubLogIn.socketLogin_Completed(a,Socket)}),Socket.on(socketEvents.socket_open_chat_completed,function(a){hubTalk&&hubTalk.socketOpenChat_Completed(a,Socket)}),Socket.on(socketEvents.socket_msg_chat_completed,
function(a){hubTalk&&hubTalk.socketMessageChat_Completed(a,Socket)}),Socket.on(socketEvents.socket_sms_notification_completed,function(a){var c=!1;a.receiver.id!==a.sender.id&&a.sender.id!==getUser().id&&(c=!0);hubSms?(c&&hubSms.hubShow(!0),hubSms.socketSms_Notification_Completed(a,Socket)):c&&(alert("You receive new SMS :)"),loadHub("sms-hub",function(c){"ok"===c&&(hubSms=new th.next.SmsHub,hubSms.hubShow(!0),hubSms.socketSms_Notification_Completed(a,Socket))}))}),Socket.on(socketEvents.socket_person_notification_completed,
function(a){hubPerson?hubPerson.personNotificationCompleted(a):loadHub("person-hub",function(c){"ok"===c&&(hubPerson=new th.next.PersonHub,hubPerson.personNotificationCompleted(a))})}))}catch(a){console.log("ERROR[client-socket-router.socketRouter()]: ",a.message)}}function setActiveChannel(a){aChannel=a}function getActiveChannel(){return aChannel}function buildChannel(a,b){for(var c=a+b,d=[],e=0;e<c.length;e++)d.push(c[e]);d.sort();c="";for(e=0;e<d.length;e++)c+=d[e];return c}
function setUser(a){User=a}function getUser(){return User}function getUserId(a){a=cloneObject(a);return{id:a.id,nick:a.nick,gender:a.gender,pic:a.pic}}function getStrUserShortProfile(a){return a.nick+", "+a.country+", "+a.language+", "+a.gender}function cutUserBirth(a){try{if(!isDefine(a)||""===a)return"";var b=a.split("-"),c=monthName[parseInt(b[0])-1];return b[1]+" "+c}catch(d){return console.log("ERROR(LoginHub.onBtnSignUp_Click())"+d),""}}
function getShortProfile(a){a=cloneObject(a);return{id:a.id,nick:a.nick,country:a.country,language:a.language,gender:a.gender,birth:a.birth,mail:a.mail}}function getUserProfile(a){a=cloneObject(a);return{id:a.id,nick:a.nick,country:a.country,language:a.language,gender:a.gender,birth:a.birth,date:a.date,pic:a.pic,socket_id:a.socket_id}}
function raiseToHighestZIndex(a){0!==zIndex?(zIndex=parseInt(zIndex+1),thJQ(a).css("z-index",zIndex)):thJQ("*").each(function(){thJQ(this);if(!thJQ(this).is("iframe")){var b=thJQ(this).css("z-index");"auto"!==b&&(b=parseInt(b),2147483647!==b&&b>zIndex&&(zIndex=parseInt(b+1),thJQ(a).css("z-index",zIndex)))}})}
function setCursor(a,b,c){a.setSelectionRange?(a.setSelectionRange(b,c),a.focus(b)):a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveEnd("character",c),a.moveStart("character",b),a.select())}function getCaret(a){if(a.selectionStart)return{posStart:a.selectionStart,posEnd:a.selectionEnd}}
function ajaxCall(a,b,c,d){try{"undefined"!==c&&(null!==c&&"undefined"!==d&&null!==d)&&thJQ.ajax({url:a,contentType:"application/json",scriptCharset:"utf-8",data:b,dataType:"jsonp",success:c,error:d})}catch(e){console.log("ERROR(client-common.ajaxCall())"+e)}}function ajaxPostFileCall(a,b,c,d){try{"undefined"!==c&&(null!==c&&"undefined"!==d&&null!==d)&&thJQ.ajax({url:a,data:b,type:"POST",success:c,error:d})}catch(e){console.log("ERROR(client-common.ajaxPostFileCall())"+e)}}
function getFileAsDataURL(a,b){try{var c=null,d=new FileReader;d.onload=function(a){c=a.target.result;sendCallBack(b(c))};d.readAsDataURL(a)}catch(e){console.log("ERROR(common-client.getFileAsDataURL()): "+e)}}function getImageDataURL(a,b,c){var d,e,f,g=new Image;g.onload=function(){e=document.createElement("canvas");e.width=g.width;e.height=g.height;f=e.getContext("2d");f.drawImage(g,0,0);try{d=e.toDataURL(),b({image:g,data:d})}catch(a){c(a)}};try{g.src=a}catch(h){c(h)}}
function GUID(){var a;a=function(){return Math.floor(4096*Math.random())};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function removeLineBreaks(a){a=a.replace(/"/g,"`");a=a.replace(/'/g,"`");a=a.replace(/\t/g," ");a=a.replace(/[%\\]/gi,"");return a=a.replace(/(\r\n|\n|\r)/gm," ")}
function encodeLineBreaksNew(a){try{if(isDefine(a))return a=a.replace(/"/g,"``"),a=a.replace(/'/g,"`"),a=a.replace(/[%\\]/gi,""),a=a.replace(/\t/g,"```t"),a=a.replace(/\n/g,"```n"),a=a.replace(/\r/g,"```r"),a=a.replace(/(\r\n)/gm,"```r```n")}catch(b){return console.log("ERROR(client-common.replaceLineBreaks())"+b),null}}
function encodeLineBreaks(a){try{if(isDefine(a))return a=a.replace(/"/g,"`"),a=a.replace(/'/g,"`"),a=a.replace(/[%\\]/gi,""),a=a.replace(/\t/g,"```t"),a=a.replace(/\n/g,"```n"),a=a.replace(/\r/g,"```r"),a=a.replace(/(\r\n)/gm,"```r```n")}catch(b){return console.log("ERROR(client-common.replaceLineBreaks())"+b),null}}
function decodeLineBreaksNew(a){try{if(isDefine(a))return a=a.replace(/``/g,'"'),a=a.replace(/`/g,"'"),a=a.replace(/```t/g,"\t"),a=a.replace(/```n/g,"\n"),a=a.replace(/```r/g,"\r"),a=a.replace(/```r```n/g,"\r\n")}catch(b){return console.log("ERROR(client-common.decodeLineBreaks())"+b),null}}
function decodeLineBreaks(a){try{if(isDefine(a))return a=a.replace(/```t/g,"\t"),a=a.replace(/```n/g,"\n"),a=a.replace(/```r/g,"\r"),a=a.replace(/```r```n/g,"\r\n")}catch(b){return console.log("ERROR(client-common.replaceLineBreaks())"+b),null}}function isJsonData(a){try{JSON.parse(a)}catch(b){return console.log("ERROR(client-common.isJsonData())"+b),!1}return!0}function getCurrentDate(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,a=a.getFullYear();return c+"-"+b+"-"+a}
function cloneObject(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor(),c;for(c in a)b[c]=this.cloneObject(a[c]);return b}function disableElements(a){for(var b=0;b<a.length;b++)a[b].disabled=!0,disableElements(a[b].children)}function enableElements(a){for(var b=0;b<a.length;b++)a[b].disabled=!1,enableElements(a[b].children)}
function getUserPerDataTemplate(a,b){try{for(var c=null,d=b.target;d;){if(-1<d.className.indexOf(a)){var e=thJQ(d).find(".template-data span").text();e&&(c={},c=JSON.parse(e));break}d=d.parentNode}return c}catch(f){return console.log("ERROR(getUserPerDataTemplate()): "+f),null}}function readLocalStorageValues(a){return window.localStorage?window.localStorage[a]:null}function saveLocalStorageValues(a,b){window.localStorage&&(window.localStorage[a]=b)}
function getAge(a){var b=new Date,c=b.getFullYear(),d=b.getMonth(),b=b.getDate(),e=a.getFullYear(),f=a.getMonth();a=a.getDate();c-=e;d-=f;if(0>d||0===d&&0>b-a)c=parseInt(c)-1;return c}function isEmailCorrect(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}
function getMetaContent(a){try{var b=document.getElementsByTagName("meta");for(i=0;i<b.length;i++)if(b[i].getAttribute("name")==a)return b[i].getAttribute("content");return""}catch(c){return console.log("ERROR(getMetaContent())"+c),""}}
function getFaviconPage(){try{for(var a="",b=document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];-1!=('"'+d.getAttribute("rel")+'"').search(/(\"icon )|( icon\")|(\"icon\")|( icon )/i)&&(a=d.getAttribute("href"))}return a}catch(e){return console.log("ERROR(getFavIcon())"+e),""}}function getDomain(){try{var a=window.location.hostname;""===a&&(a=window.location.host);""===a&&(a=document.domain);return a}catch(b){return console.log("ERROR(getDomain())"+b),""}}
function isURL(a){return RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(a)}function setCookie(a,b,c){var d=new Date;d.setTime(d.getTime()+864E5*c);c="expires="+d.toGMTString();document.cookie=a+"="+b+";domain="+getDomain()+";path=/;"+c}
function getCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].trim();if(0===d.indexOf(a))return d.substring(a.length,d.length)}return""}function delCookie(a,b){document.cookie=a+"="+b+";domain="+getDomain()+";path=/;15-Sep-1996 05:00:00 GMT"}
function sendMail(a,b,c,d,e,f,g){try{if(isDefine(a)&&isDefine(b)&&isDefine(c)&&isDefine(d)&&isDefine(f)){var h="send-mail-to-user";f!==mailNotificationType.undefine&&(h="send-notify-mail");var k=JSON.stringify({user_from:a,user_to:b,mail_subject:c,mail_message:d,notification_type:e,content_type:f});ajaxCall(pathServer+h,h+"="+k,function(a,b,c){},function(a,b,c){console.log("ERROR[ajaxCall.sendMail]: "+b)});sendCallBack(g)}}catch(l){console.log("ERROR(sendMail())"+l)}}
function sendMailToUsersID(a,b,c,d,e,f,g){try{if(isDefine(a)&&isDefine(b)&&isDefine(c)&&isDefine(d)&&isDefine(f)){var h=JSON.stringify({user_from:a,user_ids:b,mail_subject:c,mail_message:d,notification_type:e,content_type:f});ajaxCall(pathServer+"send-notify-mail-users-id","send-notify-mail-users-id="+h,function(a,b,c){},function(a,b,c){console.log("ERROR[ajaxCall.sendMail]: "+b)});sendCallBack(g)}}catch(k){console.log("ERROR(sendMail(send-notify-mail-per-user-ids))"+k)}};
